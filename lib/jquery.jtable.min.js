(function(a){a.widget("hik.jtable",{tastypie:{filters:{done:function(a){var b={Result:"OK",Records:a.objects,TotalRecordCount:a.meta.total_count};return b;}}},options:{actions:{},tastypie:false,response_filters:{},fields:{},animationsEnabled:true,defaultDateFormat:'yy-mm-dd',dialogShowEffect:'fade',dialogHideEffect:'fade',showCloseButton:false,loadingAnimationDelay:500,saveUserPreferences:true,jqueryuiTheme:false,ajaxSettings:{type:'POST',dataType:'json'},toolbar:{hoverAnimation:true,hoverAnimationDuration:60,hoverAnimationEasing:undefined,items:[]},closeRequested:function(a,b){},formCreated:function(a,b){},formSubmitting:function(a,b){},formClosed:function(a,b){},loadingRecords:function(a,b){},recordsLoaded:function(a,b){},rowInserted:function(a,b){},rowsRemoved:function(a,b){},messages:{serverCommunicationError:'An error occured while communicating to the server.',loadingMessage:'Loading records...',noDataAvailable:'No data available!',areYouSure:'Are you sure?',save:'Save',saving:'Saving',cancel:'Cancel',error:'Error',close:'Close',cannotLoadOptionsFor:'Can not load options for field {0}'}},_$mainContainer:null,_$titleDiv:null,_$toolbarDiv:null,_$table:null,_$tableBody:null,_$tableRows:null,_$busyDiv:null,_$busyMessageDiv:null,_$errorDialogDiv:null,_columnList:null,_fieldList:null,_keyField:null,_firstDataColumnOffset:0,_lastPostData:null,_cache:null,_create:function(){this._normalizeFieldsOptions();this._initializeFields();this._createFieldAndColumnList();this._createMainContainer();this._createTableTitle();this._createToolBar();this._createTable();this._createBusyPanel();this._createErrorDialogDiv();this._addNoDataRow();this._cookieKeyPrefix=this._generateCookieKeyPrefix();},_normalizeFieldsOptions:function(){var b=this;a.each(b.options.fields,function(a,c){b._normalizeFieldOptions(a,c);});},_normalizeFieldOptions:function(b,c){if(c.listClass==undefined)c.listClass='';if(c.inputClass==undefined)c.inputClass='';if(c.dependsOn&&a.type(c.dependsOn)==='string'){var d=c.dependsOn.split(',');c.dependsOn=[];for(var e=0;e<d.length;e++)c.dependsOn.push(a.trim(d[e]));}},_initializeFields:function(){this._lastPostData={};this._$tableRows=[];this._columnList=[];this._fieldList=[];this._cache=[];},_createFieldAndColumnList:function(){var b=this;a.each(b.options.fields,function(a,c){b._fieldList.push(a);if(c.key==true)b._keyField=a;if(c.list!=false&&c.type!='hidden')b._columnList.push(a);});},_createMainContainer:function(){this._$mainContainer=a('<div />').addClass('jtable-main-container').appendTo(this.element);this._jqueryuiThemeAddClass(this._$mainContainer,'ui-widget');},_createTableTitle:function(){var b=this;if(!b.options.title)return;var c=a('<div />').addClass('jtable-title').appendTo(b._$mainContainer);b._jqueryuiThemeAddClass(c,'ui-widget-header');a('<div />').addClass('jtable-title-text').appendTo(c).append(b.options.title);if(b.options.showCloseButton){var d=a('<span />').html(b.options.messages.close);a('<button></button>').addClass('jtable-command-button jtable-close-button').attr('title',b.options.messages.close).append(d).appendTo(c).click(function(a){a.preventDefault();a.stopPropagation();b._onCloseRequested();});}b._$titleDiv=c;},_createTable:function(){this._$table=a('<table></table>').addClass('jtable').appendTo(this._$mainContainer);if(this.options.tableId)this._$table.attr('id',this.options.tableId);this._jqueryuiThemeAddClass(this._$table,'ui-widget-content');this._createTableHead();this._createTableBody();},_createTableHead:function(){var b=a('<thead></thead>').appendTo(this._$table);this._addRowToTableHead(b);},_addRowToTableHead:function(b){var c=a('<tr></tr>').appendTo(b);this._addColumnsToHeaderRow(c);},_addColumnsToHeaderRow:function(a){for(var b=0;b<this._columnList.length;b++){var c=this._columnList[b];var d=this._createHeaderCellForField(c,this.options.fields[c]);d.appendTo(a);}},_createHeaderCellForField:function(b,c){c.width=c.width||'10%';var d=a('<span />').addClass('jtable-column-header-text').html(c.title);var e=a('<div />').addClass('jtable-column-header-container').append(d);var f=a('<th></th>').addClass('jtable-column-header').addClass(c.listClass).css('width',c.width).data('fieldName',b).append(e);this._jqueryuiThemeAddClass(f,'ui-state-default');return f;},_createEmptyCommandHeader:function(){var b=a('<th></th>').addClass('jtable-command-column-header').css('width','1%');this._jqueryuiThemeAddClass(b,'ui-state-default');return b;},_createTableBody:function(){this._$tableBody=a('<tbody></tbody>').appendTo(this._$table);},_createBusyPanel:function(){this._$busyMessageDiv=a('<div />').addClass('jtable-busy-message').prependTo(this._$mainContainer);this._$busyDiv=a('<div />').addClass('jtable-busy-panel-background').prependTo(this._$mainContainer);this._jqueryuiThemeAddClass(this._$busyMessageDiv,'ui-widget-header');this._hideBusy();},_createErrorDialogDiv:function(){var b=this;b._$errorDialogDiv=a('<div></div>').appendTo(b._$mainContainer);b._$errorDialogDiv.dialog({autoOpen:false,show:b.options.dialogShowEffect,hide:b.options.dialogHideEffect,modal:true,title:b.options.messages.error,buttons:[{text:b.options.messages.close,click:function(){b._$errorDialogDiv.dialog('close');}}]});},load:function(a,b){this._lastPostData=a;this._reloadTable(b);},reload:function(a){this._reloadTable(a);},getRowByKey:function(a){for(var b=0;b<this._$tableRows.length;b++)if(a==this._getKeyValueOfRecord(this._$tableRows[b].data('record')))return this._$tableRows[b];return null;},destroy:function(){this.element.empty();a.Widget.prototype.destroy.call(this);},_setOption:function(a,b){},_reloadTable:function(b){var c=this;c._showBusy(c.options.messages.loadingMessage,c.options.loadingAnimationDelay);var d=c._createRecordLoadUrl();c._onLoadingRecords();c._ajax({url:d,data:c._lastPostData,traditional:this.options.tastypie,type:this.options.tastypie?'GET':'POST',success:function(a){c._hideBusy();if(a.Result!='OK'){c._showError(a.Message);return;}c._removeAllRows('reloading');c._addRecordsToTable(a.Records);c._onRecordsLoaded(a);if(b)b();},error:function(b,d,e){c._hideBusy();var f=b.responseText;var g=a.parseJSON(f);var h=c.options.messages.serverCommunicationError;var i=(g&&g.error)||h;c._showError(i);}});},_createRecordLoadUrl:function(){return this.options.actions.listAction||this.options.url;},_createRowFromRecord:function(b){var c=a('<tr></tr>').addClass('jtable-data-row').attr('data-record-key',this._getKeyValueOfRecord(b)).data('record',b);this._addCellsToRowUsingRecord(c);return c;},_addCellsToRowUsingRecord:function(a){var b=a.data('record');for(var c=0;c<this._columnList.length;c++)this._createCellForRecordField(b,this._columnList[c]).appendTo(a);},_createCellForRecordField:function(b,c){return a('<td></td>').addClass(this.options.fields[c].listClass).append((this._getDisplayTextForRecordField(b,c)));},_addRecordsToTable:function(b){var c=this;a.each(b,function(a,b){c._addRow(c._createRowFromRecord(b));});c._refreshRowStyles();},_addRowToTable:function(a,b,c,d){var e={index:this._normalizeNumber(b,0,this._$tableRows.length,this._$tableRows.length)};if(c==true)e.isNewRow=true;if(d==false)e.animationsEnabled=false;this._addRow(a,e);},_addRow:function(b,c){c=a.extend({index:this._$tableRows.length,isNewRow:false,animationsEnabled:true},c);if(this._$tableRows.length<=0)this._removeNoDataRow();c.index=this._normalizeNumber(c.index,0,this._$tableRows.length,this._$tableRows.length);if(c.index==this._$tableRows.length){this._$tableBody.append(b);this._$tableRows.push(b);}else if(c.index==0){this._$tableBody.prepend(b);this._$tableRows.unshift(b);}else{this._$tableRows[c.index-1].after(b);this._$tableRows.splice(c.index,0,b);}this._onRowInserted(b,c.isNewRow);if(c.isNewRow){this._refreshRowStyles();if(this.options.animationsEnabled&&c.animationsEnabled)this._showNewRowAnimation(b);}},_showNewRowAnimation:function(a){var b='jtable-row-created';if(this.options.jqueryuiTheme)b=b+' ui-state-highlight';a.addClass(b,'slow','',function(){a.removeClass(b,5000);});},_removeRowsFromTable:function(b,c){var d=this;if(b.length<=0)return;b.addClass('jtable-row-removed').remove();b.each(function(){var b=d._findRowIndex(a(this));if(b>=0)d._$tableRows.splice(b,1);});d._onRowsRemoved(b,c);if(d._$tableRows.length==0)d._addNoDataRow();d._refreshRowStyles();},_findRowIndex:function(a){return this._findIndexInArray(a,this._$tableRows,function(a,b){return a.data('record')==b.data('record');});},_removeAllRows:function(a){if(this._$tableRows.length<=0)return;var b=this._$tableBody.find('tr.jtable-data-row');this._$tableBody.empty();this._$tableRows=[];this._onRowsRemoved(b,a);this._addNoDataRow();},_addNoDataRow:function(){if(this._$tableBody.find('>tr.jtable-no-data-row').length>0)return;var b=a('<tr></tr>').addClass('jtable-no-data-row').appendTo(this._$tableBody);var c=this._$table.find('thead th').length;a('<td></td>').attr('colspan',c).html(this.options.messages.noDataAvailable).appendTo(b);},_removeNoDataRow:function(){this._$tableBody.find('.jtable-no-data-row').remove();},_refreshRowStyles:function(){for(var a=0;a<this._$tableRows.length;a++)if(a%2==0)this._$tableRows[a].addClass('jtable-row-even');else this._$tableRows[a].removeClass('jtable-row-even');},_getDisplayTextForRecordField:function(a,b){var c=this.options.fields[b];var d=a[b];if(c.display)return c.display({record:a});if(c.type=='date')return this._getDisplayTextForDateRecordField(c,d);else if(c.type=='checkbox')return this._getCheckBoxTextForFieldByValue(b,d);else if(c.options){var e=this._getOptionsForField(b,{record:a,value:d,source:'list',dependedValues:this._createDependedValuesUsingRecord(a,c.dependsOn)});return this._findOptionByValue(e,d).DisplayText;}else return d;},_createDependedValuesUsingRecord:function(a,b){if(!b)return{};var c={};for(var d=0;d<b.length;d++)c[b[d]]=a[b[d]];return c;},_findOptionByValue:function(a,b){for(var c=0;c<a.length;c++)if(a[c].Value==b)return a[c];return{};},_getDisplayTextForDateRecordField:function(b,c){if(!c)return '';var d=b.displayFormat||this.options.defaultDateFormat;var e=this._parseDate(c);return a.datepicker.formatDate(d,e);},_getOptionsForField:function(b,c){var d=this.options.fields[b];var e=d.options;if(a.isFunction(e)){c=a.extend(true,{_cacheCleared:false,dependedValues:{},clearCache:function(){this._cacheCleared=true;}},c);e=e(c);}var f;if(typeof e=='string'){var g='options_'+b+'_'+e;if(c._cacheCleared||(!this._cache[g])){this._cache[g]=this._buildOptionsFromArray(this._downloadOptions(b,e));this._sortFieldOptions(this._cache[g],d.optionsSorting);}else if(c.value!=undefined){var h=this._findOptionByValue(this._cache[g],c.value);if(h.DisplayText==undefined){this._cache[g]=this._buildOptionsFromArray(this._downloadOptions(b,e));this._sortFieldOptions(this._cache[g],d.optionsSorting);}}f=this._cache[g];}else if(jQuery.isArray(e)){f=this._buildOptionsFromArray(e);this._sortFieldOptions(f,d.optionsSorting);}else{f=this._buildOptionsArrayFromObject(e);this._sortFieldOptions(f,d.optionsSorting);}return f;},_downloadOptions:function(a,b){var c=this;var d=[];c._ajax({url:b,async:false,type:c.options.tastypie?'GET':'POST',success:function(a){if(a.Result!='OK'){c._showError(a.Message);return;}d=a.Options;},error:function(){var b=c._formatString(c.options.messages.cannotLoadOptionsFor,a);c._showError(b);}});return d;},_sortFieldOptions:function(b,c){if((!b)||(!b.length)||(!c))return;var d;if(c.indexOf('value')==0)d=function(a){return a.Value;};else d=function(a){return a.DisplayText;};var e;if(a.type(d(b[0]))=='string')e=function(a,b){return d(a).localeCompare(d(b));};else e=function(a,b){return d(a)-d(b);};if(c.indexOf('desc')>0)b.sort(function(a,b){return e(b,a);});else b.sort(function(a,b){return e(a,b);});},_buildOptionsArrayFromObject:function(b){var c=[];a.each(b,function(a,b){c.push({Value:a,DisplayText:b});});return c;},_buildOptionsFromArray:function(b){var c=[];for(var d=0;d<b.length;d++)if(a.isPlainObject(b[d]))c.push(b[d]);else c.push({Value:b[d],DisplayText:b[d]});return c;},_parseDate:function(a){if(a.indexOf('Date')>=0)return new Date(parseInt(a.substr(6),10));else if(a.length==10)return new Date(parseInt(a.substr(0,4),10),parseInt(a.substr(5,2),10)-1,parseInt(a.substr(8,2),10));else if(a.length>=19)return new Date(parseInt(a.substr(0,4),10),parseInt(a.substr(5,2),10)-1,parseInt(a.substr(8,2,10)),parseInt(a.substr(11,2),10),parseInt(a.substr(14,2),10),parseInt(a.substr(17,2),10));else{this._logWarn('Given date is not properly formatted: '+a);return 'format error!';}},_createToolBar:function(){this._$toolbarDiv=a('<div />').addClass('jtable-toolbar').appendTo(this._$titleDiv);for(var b=0;b<this.options.toolbar.items.length;b++)this._addToolBarItem(this.options.toolbar.items[b]);},_addToolBarItem:function(b){if((b==undefined)||(b.text==undefined&&b.icon==undefined)){this._logWarn('Can not add tool bar item since it is not valid!');this._logWarn(b);return null;}var c=a('<span></span>').addClass('jtable-toolbar-item').appendTo(this._$toolbarDiv);this._jqueryuiThemeAddClass(c,'ui-widget ui-state-default ui-corner-all','ui-state-hover');if(b.cssClass)c.addClass(b.cssClass);if(b.tooltip)c.attr('title',b.tooltip);if(b.icon){var d=a('<span class="jtable-toolbar-item-icon"></span>').appendTo(c);if(b.icon===true){}else if(a.type(b.icon==='string'))d.css('background','url("'+b.icon+'")');}if(b.text)a('<span class=""></span>').html(b.text).addClass('jtable-toolbar-item-text').appendTo(c);if(b.click)c.click(function(){b.click();});var e=undefined;var f=undefined;if(this.options.toolbar.hoverAnimation){e=this.options.toolbar.hoverAnimationDuration;f=this.options.toolbar.hoverAnimationEasing;}c.hover(function(){c.addClass('jtable-toolbar-item-hover',e,f);},function(){c.removeClass('jtable-toolbar-item-hover',e,f);});return c;},_showError:function(a){this._$errorDialogDiv.html(a).dialog('open');},_setBusyTimer:null,_showBusy:function(a,b){var c=this;c._$busyDiv.width(c._$mainContainer.width()).height(c._$mainContainer.height()).addClass('jtable-busy-panel-background-invisible').show();var d=function(){c._$busyDiv.removeClass('jtable-busy-panel-background-invisible');c._$busyMessageDiv.html(a).show();};if(b){if(c._setBusyTimer)return;c._setBusyTimer=setTimeout(d,b);}else d();},_hideBusy:function(){clearTimeout(this._setBusyTimer);this._setBusyTimer=null;this._$busyDiv.hide();this._$busyMessageDiv.html('').hide();},_isBusy:function(){return this._$busyMessageDiv.is(':visible');},_jqueryuiThemeAddClass:function(a,b,c){if(!this.options.jqueryuiTheme)return;a.addClass(b);if(c)a.hover(function(){a.addClass(c);},function(){a.removeClass(c);});},_performAjaxCall:function(a,b,c,d,e){this._ajax({url:a,data:b,async:c,success:d,error:e});},_ajax:function(b){var c=b.success;var d=b.error;b.success=null;b.error=null;var e=a.extend({},this.options.ajaxSettings,b);var f=function(a){if(c)c(a);};var g=function(){if(d)d.apply(this,arguments);};var h=function(){if(b.complete)b.complete();};var i=a.ajax(e);if(this.options.tastypie)i=i.then(this.tastypie.filters.done,this.tastypie.filters.fail);i.then(this.options.response_filters.done,this.options.response_filters.fail).done(f).fail(g).always(h);},_getKeyValueOfRecord:function(a){return a[this._keyField];},_setCookie:function(a,b){a=this._cookieKeyPrefix+a;var c=new Date();c.setDate(c.getDate()+30);document.cookie=encodeURIComponent(a)+'='+encodeURIComponent(b)+"; expires="+c.toUTCString();},_getCookie:function(a){a=this._cookieKeyPrefix+a;var b=document.cookie.split('; ');for(var c=0;c<b.length;c++){if(!b[c])continue;var d=b[c].split('=');if(d.length!=2)continue;if(decodeURIComponent(d[0])===a)return decodeURIComponent(d[1]||'');}return null;},_generateCookieKeyPrefix:function(){var a=function(a){var b=0;if(a.length==0)return b;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b=((b<<5)-b)+d;b=b&b;}return b;};var b='';if(this.options.tableId)b=b+this.options.tableId+'#';b=b+this._columnList.join('$')+'#c'+this._$table.find('thead th').length;return 'jtable#'+a(b);},_onLoadingRecords:function(){this._trigger("loadingRecords",null,{});},_onRecordsLoaded:function(a){this._trigger("recordsLoaded",null,{records:a.Records,serverResponse:a});},_onRowInserted:function(a,b){this._trigger("rowInserted",null,{row:a,record:a.data('record'),isNewRow:b});},_onRowsRemoved:function(a,b){this._trigger("rowsRemoved",null,{rows:a,reason:b});},_onCloseRequested:function(){this._trigger("closeRequested",null,{});}});}(jQuery));(function(a){a.extend(true,a.hik.jtable.prototype,{_getPropertyOfObject:function(a,b){if(b.indexOf('.')<0)return a[b];else{var c=b.substring(0,b.indexOf('.'));var d=b.substring(b.indexOf('.')+1);return this._getPropertyOfObject(a[c],d);}},_setPropertyOfObject:function(a,b,c){if(b.indexOf('.')<0)a[b]=c;else{var d=b.substring(0,b.indexOf('.'));var e=b.substring(b.indexOf('.')+1);this._setPropertyOfObject(a[d],e,c);}},_insertToArrayIfDoesNotExists:function(b,c){if(a.inArray(c,b)<0)b.push(c);},_findIndexInArray:function(a,b,c){if(!c)c=function(a,b){return a==b;};for(var d=0;d<b.length;d++)if(c(a,b[d]))return d;return -1;},_normalizeNumber:function(a,b,c,d){if(a==undefined||a==null||isNaN(a))return d;if(a<b)return b;if(a>c)return c;return a;},_formatString:function(){if(arguments.length==0)return null;var a=arguments[0];for(var b=1;b<arguments.length;b++){var c='{'+(b-1)+'}';a=a.replace(c,arguments[b]);}return a;},_logDebug:function(a){if(!window.console)return;console.log('jTable DEBUG: '+a);},_logInfo:function(a){if(!window.console)return;console.log('jTable INFO: '+a);},_logWarn:function(a){if(!window.console)return;console.log('jTable WARNING: '+a);},_logError:function(a){if(!window.console)return;console.log('jTable ERROR: '+a);}});if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){var b=this.length;var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0)c+=b;for(;c<b;c++)if(c in this&&this[c]===a)return c;return -1;};})(jQuery);(function(a){a.extend(true,a.hik.jtable.prototype,{_submitFormUsingAjax:function(a,b,c,d){this._ajax({url:a,data:b,success:c,error:d});},_createInputLabelForRecordField:function(b){return a('<div />').addClass('jtable-input-label').html(this.options.fields[b].inputTitle||this.options.fields[b].title);},_createInputForRecordField:function(b){var c=b.fieldName,d=b.value,e=b.record,f=b.formType,g=b.form;var h=this.options.fields[c];if(d==undefined||d==null)d=h.defaultValue;if(h.input){var i=a(h.input({value:d,record:e,formType:f,form:g}));if(!i.attr('id'))i.attr('id','Edit-'+c);return a('<div />').addClass('jtable-input jtable-custom-input').append(i);}if(h.type=='date')return this._createDateInputForField(h,c,d);else if(h.type=='textarea')return this._createTextAreaForField(h,c,d);else if(h.type=='password')return this._createPasswordInputForField(h,c,d);else if(h.type=='checkbox')return this._createCheckboxForField(h,c,d);else if(h.options)if(h.type=='radiobutton')return this._createRadioButtonListForField(h,c,d,e,f);else return this._createDropDownListForField(h,c,d,e,f,g);else return this._createTextInputForField(h,c,d);},_createInputForHidden:function(b,c){if(c==undefined)c="";return a('<input type="hidden" name="'+b+'" id="Edit-'+b+'"></input>').val(c);},_createDateInputForField:function(b,c,d){var e=a('<input class="'+b.inputClass+'" id="Edit-'+c+'" type="text" name="'+c+'"></input>');if(d!=undefined)e.val(d);var f=b.displayFormat||this.options.defaultDateFormat;e.datepicker({dateFormat:f});return a('<div />').addClass('jtable-input jtable-date-input').append(e);},_createTextAreaForField:function(b,c,d){var e=a('<textarea class="'+b.inputClass+'" id="Edit-'+c+'" name="'+c+'"></textarea>');if(d!=undefined)e.val(d);return a('<div />').addClass('jtable-input jtable-textarea-input').append(e);},_createTextInputForField:function(b,c,d){var e=a('<input class="'+b.inputClass+'" id="Edit-'+c+'" type="text" name="'+c+'"></input>');if(d!=undefined)e.val(d);return a('<div />').addClass('jtable-input jtable-text-input').append(e);},_createPasswordInputForField:function(b,c,d){var e=a('<input class="'+b.inputClass+'" id="Edit-'+c+'" type="password" name="'+c+'"></input>');if(d!=undefined)e.val(d);return a('<div />').addClass('jtable-input jtable-password-input').append(e);},_createCheckboxForField:function(b,c,d){var e=this;if(d==undefined)d=e._getCheckBoxPropertiesForFieldByState(c,false).Value;var f=a('<div />').addClass('jtable-input jtable-checkbox-input');var g=a('<input class="'+b.inputClass+'" id="Edit-'+c+'" type="checkbox" name="'+c+'" />').appendTo(f);if(d!=undefined)g.val(d);var h=a('<span>'+(b.formText||e._getCheckBoxTextForFieldByValue(c,d))+'</span>').appendTo(f);if(e._getIsCheckBoxSelectedForFieldByValue(c,d))g.attr('checked','checked');var i=function(){var a=e._getCheckBoxPropertiesForFieldByState(c,g.is(':checked'));g.attr('value',a.Value);h.html(b.formText||a.DisplayText);};g.click(function(){i();});if(b.setOnTextClick!=false)h.addClass('jtable-option-text-clickable').click(function(){if(g.is(':checked'))g.attr('checked',false);else g.attr('checked',true);i();});return f;},_createDropDownListForField:function(b,c,d,e,f,g){var h=a('<div />').addClass('jtable-input jtable-dropdown-input');var i=a('<select class="'+b.inputClass+'" id="Edit-'+c+'" name="'+c+'"></select>').appendTo(h);var j=this._getOptionsForField(c,{record:e,source:f,form:g,dependedValues:this._createDependedValuesUsingForm(g,b.dependsOn)});this._fillDropDownListWithOptions(i,j,d);return h;},_fillDropDownListWithOptions:function(b,c,d){b.empty();for(var e=0;e<c.length;e++)a('<option'+(c[e].Value==d?' selected="selected"':'')+'>'+c[e].DisplayText+'</option>').val(c[e].Value).appendTo(b);},_createDependedValuesUsingForm:function(a,b){if(!b)return{};var c={};for(var d=0;d<b.length;d++){var e=b[d];var f=a.find('select[name='+e+']');if(f.length<=0)continue;c[e]=f.val();}return c;},_createRadioButtonListForField:function(b,c,d,e,f){var g=a('<div />').addClass('jtable-input jtable-radiobuttonlist-input');var h=this._getOptionsForField(c,{record:e,source:f});a.each(h,function(e,f){var h=a('<div class=""></div>').addClass('jtable-radio-input').appendTo(g);var i=a('<input type="radio" id="Edit-'+c+'-'+e+'" class="'+b.inputClass+'" name="'+c+'"'+((f.Value==(d+''))?' checked="true"':'')+' />').val(f.Value).appendTo(h);var j=a('<span></span>').html(f.DisplayText).appendTo(h);if(b.setOnTextClick!=false)j.addClass('jtable-option-text-clickable').click(function(){if(!i.is(':checked'))i.attr('checked',true);});});return g;},_getCheckBoxTextForFieldByValue:function(a,b){return this.options.fields[a].values[b];},_getIsCheckBoxSelectedForFieldByValue:function(a,b){return(this._createCheckBoxStateArrayForFieldWithCaching(a)[1].Value.toString()==b.toString());},_getCheckBoxPropertiesForFieldByState:function(a,b){return this._createCheckBoxStateArrayForFieldWithCaching(a)[(b?1:0)];},_createCheckBoxStateArrayForFieldWithCaching:function(a){var b='checkbox_'+a;if(!this._cache[b])this._cache[b]=this._createCheckBoxStateArrayForField(a);return this._cache[b];},_createCheckBoxStateArrayForField:function(b){var c=[];var d=0;a.each(this.options.fields[b].values,function(a,b){if(d++<2)c.push({'Value':a,'DisplayText':b});});return c;},_makeCascadeDropDowns:function(b,c,d){var e=this;b.find('select').each(function(){var f=a(this);var g=f.attr('name');if(!g)return;var h=e.options.fields[g];if(!h.dependsOn)return;a.each(h.dependsOn,function(a,i){var j=b.find('select[name='+i+']');j.change(function(){var a={record:c,source:d,form:b,dependedValues:{}};a.dependedValues=e._createDependedValuesUsingForm(b,h.dependsOn);var i=e._getOptionsForField(g,a);e._fillDropDownListWithOptions(f,i,undefined);f.change();});});});},_updateRecordValuesFromForm:function(b,c){for(var d=0;d<this._fieldList.length;d++){var e=this._fieldList[d];var f=this.options.fields[e];if(f.edit==false)continue;var g=c.find('[name="'+e+'"]');if(g.length<=0)continue;if(f.type=='date'){var h=g.val();if(h){var i=f.displayFormat||this.options.defaultDateFormat;try{var j=a.datepicker.parseDate(i,h);b[e]='/Date('+j.getTime()+')/';}catch(k){this._logWarn('Date format is incorrect for field '+e+': '+h);b[e]=undefined;}}else{this._logDebug('Date is empty for '+e);b[e]=undefined;}}else if(f.options&&f.type=='radiobutton'){var l=g.filter(':checked');if(l.length)b[e]=l.val();else b[e]=undefined;}else b[e]=g.val();}},_setEnabledOfDialogButton:function(a,b,c){if(!a)return;if(b!=false)a.removeAttr('disabled').removeClass('ui-state-disabled');else a.attr('disabled','disabled').addClass('ui-state-disabled');if(c)a.find('span').text(c);}});})(jQuery);(function(a){var b={_create:a.hik.jtable.prototype._create};a.extend(true,a.hik.jtable.prototype,{options:{recordAdded:function(a,b){},messages:{addNewRecord:'Add new record'}},_$addRecordDiv:null,_create:function(){b._create.apply(this,arguments);this._createAddRecordDialogDiv();},_createAddRecordDialogDiv:function(){var b=this;if(!b.options.actions.createAction)return;b._$addRecordDiv=a('<div />').appendTo(b._$mainContainer);b._$addRecordDiv.dialog({autoOpen:false,show:b.options.dialogShowEffect,hide:b.options.dialogHideEffect,width:'auto',minWidth:'300',modal:true,title:b.options.messages.addNewRecord,buttons:[{text:b.options.messages.cancel,click:function(){b._$addRecordDiv.dialog('close');}},{id:'AddRecordDialogSaveButton',text:b.options.messages.save,click:function(){var c=a('#AddRecordDialogSaveButton');var d=b._$addRecordDiv.find('form');if(b._trigger("formSubmitting",null,{form:d,formType:'create'})!=false){b._setEnabledOfDialogButton(c,false,b.options.messages.saving);b._saveAddRecordForm(d,c);}}}],close:function(){var c=b._$addRecordDiv.find('form').first();var d=a('#AddRecordDialogSaveButton');b._trigger("formClosed",null,{form:c,formType:'create'});b._setEnabledOfDialogButton(d,true,b.options.messages.save);c.remove();}});if(b.options.addRecordButton)b.options.addRecordButton.click(function(a){a.preventDefault();b._showAddRecordForm();});else b._addToolBarItem({icon:true,cssClass:'jtable-toolbar-item-add-record',text:b.options.messages.addNewRecord,click:function(){b._showAddRecordForm();}});},showCreateForm:function(){this._showAddRecordForm();},addRecord:function(b){var c=this;b=a.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:c.options.actions.createAction,success:function(){},error:function(){}},b);if(!b.record){c._logWarn('options parameter in addRecord method must contain a record property.');return;}if(b.clientOnly){c._addRow(c._createRowFromRecord(b.record),{isNewRow:true,animationsEnabled:b.animationsEnabled});b.success();return;}c._submitFormUsingAjax(b.url,a.param(b.record),function(a){if(a.Result!='OK'){c._showError(a.Message);b.error(a);return;}if(!a.Record){c._logError('Server must return the created Record object.');b.error(a);return;}c._onRecordAdded(a);c._addRow(c._createRowFromRecord(a.Record),{isNewRow:true,animationsEnabled:b.animationsEnabled});b.success(a);},function(){c._showError(c.options.messages.serverCommunicationError);b.error();});},_showAddRecordForm:function(){var b=this;var c=a('<form id="jtable-create-form" class="jtable-dialog-form jtable-create-form" action="'+b.options.actions.createAction+'" method="POST"></form>');for(var d=0;d<b._fieldList.length;d++){var e=b._fieldList[d];var f=b.options.fields[e];if(f.key==true&&f.create!=true)continue;if(f.create==false)continue;if(f.type=='hidden'){c.append(b._createInputForHidden(e,f.defaultValue));continue;}var g=a('<div />').addClass('jtable-input-field-container').appendTo(c);g.append(b._createInputLabelForRecordField(e));g.append(b._createInputForRecordField({fieldName:e,formType:'create',form:c}));}b._makeCascadeDropDowns(c,undefined,'create');b._$addRecordDiv.append(c).dialog('open');b._trigger("formCreated",null,{form:c,formType:'create'});},_saveAddRecordForm:function(a,b){var c=this;a.data('submitting',true);c._submitFormUsingAjax(a.attr('action'),a.serialize(),function(a){if(a.Result!='OK'){c._showError(a.Message);c._setEnabledOfDialogButton(b,true,c.options.messages.save);return;}if(!a.Record){c._logError('Server must return the created Record object.');c._setEnabledOfDialogButton(b,true,c.options.messages.save);return;}c._onRecordAdded(a);c._addRow(c._createRowFromRecord(a.Record),{isNewRow:true});c._$addRecordDiv.dialog("close");},function(){c._showError(c.options.messages.serverCommunicationError);c._setEnabledOfDialogButton(b,true,c.options.messages.save);});},_onRecordAdded:function(a){this._trigger("recordAdded",null,{record:a.Record,serverResponse:a});}});})(jQuery);(function(a){var b={_create:a.hik.jtable.prototype._create,_addColumnsToHeaderRow:a.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:a.hik.jtable.prototype._addCellsToRowUsingRecord};a.extend(true,a.hik.jtable.prototype,{options:{recordUpdated:function(a,b){},rowUpdated:function(a,b){},messages:{editRecord:'Edit Record'}},_$editDiv:null,_$editingRow:null,_create:function(){b._create.apply(this,arguments);this._createEditDialogDiv();},_createEditDialogDiv:function(){var b=this;b._$editDiv=a('<div></div>').appendTo(b._$mainContainer);b._$editDiv.dialog({autoOpen:false,show:b.options.dialogShowEffect,hide:b.options.dialogHideEffect,width:b.options.dialogWidth||'auto',minWidth:'300',modal:true,title:b.options.messages.editRecord,buttons:[{text:b.options.messages.cancel,click:function(){b._$editDiv.dialog('close');}},{id:'EditDialogSaveButton',text:b.options.messages.save,click:function(){if(b._$editingRow.hasClass('jtable-row-removed')){b._$editDiv.dialog('close');return;}var a=b._$editDiv.find('#EditDialogSaveButton');var c=b._$editDiv.find('form');if(b._trigger("formSubmitting",null,{form:c,formType:'edit',row:b._$editingRow})!=false){b._setEnabledOfDialogButton(a,false,b.options.messages.saving);b._saveEditForm(c,a);}}}],close:function(){var c=b._$editDiv.find('form:first');var d=a('#EditDialogSaveButton');b._trigger("formClosed",null,{form:c,formType:'edit',row:b._$editingRow});b._setEnabledOfDialogButton(d,true,b.options.messages.save);c.remove();}});},updateRecord:function(b){var c=this;b=a.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:(c.tastypie?c.options.url:c.options.actions.updateAction),success:function(){},error:function(){}},b);if(!b.record){c._logWarn('options parameter in updateRecord method must contain a record property.');return;}var d=c._getKeyValueOfRecord(b.record);if(d==undefined||d==null){c._logWarn('options parameter in updateRecord method must contain a record that contains the key field property.');return;}var e=c.getRowByKey(d);if(e==null){c._logWarn('Can not found any row by key: '+d);return;}if(b.clientOnly){a.extend(e.data('record'),b.record);c._updateRowTexts(e);c._onRecordUpdated(e,null);if(b.animationsEnabled)c._showUpdateAnimationForRow(e);b.success();return;}c._submitFormUsingAjax(b.url,a.param(b.record),function(d){if(d.Result!='OK'){c._showError(d.Message);b.error(d);return;}a.extend(e.data('record'),b.record);c._updateRecordValuesFromServerResponse(e.data('record'),d);c._updateRowTexts(e);c._onRecordUpdated(e,d);if(b.animationsEnabled)c._showUpdateAnimationForRow(e);b.success(d);},function(){c._showError(c.options.messages.serverCommunicationError);b.error();});},_addColumnsToHeaderRow:function(a){b._addColumnsToHeaderRow.apply(this,arguments);if(this.options.actions.updateAction!=undefined||(this.options.tastypie&&this.options.editable))a.append(this._createEmptyCommandHeader());},_addCellsToRowUsingRecord:function(c){var d=this;b._addCellsToRowUsingRecord.apply(this,arguments);if(d.options.actions.updateAction!=undefined||(d.options.tastypie&&d.options.editable)){var e=a('<span></span>').html(d.options.messages.editRecord);var f=a('<button title="'+d.options.messages.editRecord+'"></button>').addClass('jtable-command-button jtable-edit-command-button').append(e).click(function(a){a.preventDefault();a.stopPropagation();d._showEditForm(c);});a('<td></td>').addClass('jtable-command-column').append(f).appendTo(c);}},_showEditForm:function(b){var c=this;var d=b.data('record');var e=c.options.tastypie?c.options.url:c.options.actions.updateAction;var f=a('<form id="jtable-edit-form" class="jtable-dialog-form jtable-edit-form" action="'+e+'" method="POST"></form>');for(var g=0;g<c._fieldList.length;g++){var h=c._fieldList[g];var i=c.options.fields[h];var j=d[h];if(i.key==true)if(i.edit!=true){f.append(c._createInputForHidden(h,j));continue;}else f.append(c._createInputForHidden('jtRecordKey',j));if(i.edit==false)continue;if(i.type=='hidden'){f.append(c._createInputForHidden(h,j));continue;}var k=a('<div class="jtable-input-field-container"></div>').appendTo(f);k.append(c._createInputLabelForRecordField(h));var l=c._getValueForRecordField(d,h);k.append(c._createInputForRecordField({fieldName:h,value:l,record:d,formType:'edit',form:f}));}c._makeCascadeDropDowns(f,d,'edit');c._$editingRow=b;c._$editDiv.append(f).dialog('open');c._trigger("formCreated",null,{form:f,formType:'edit',record:d,row:b});},_saveEditForm:function(a,b){var c=this;c._submitFormUsingAjax(a.attr('action'),a.serialize(),function(d){if(d.Result!='OK'){c._showError(d.Message);c._setEnabledOfDialogButton(b,true,c.options.messages.save);return;}var e=c._$editingRow.data('record');c._updateRecordValuesFromForm(e,a);c._updateRecordValuesFromServerResponse(e,d);c._updateRowTexts(c._$editingRow);c._$editingRow.attr('data-record-key',c._getKeyValueOfRecord(e));c._onRecordUpdated(c._$editingRow,d);if(c.options.animationsEnabled)c._showUpdateAnimationForRow(c._$editingRow);c._$editDiv.dialog("close");},function(){c._showError(c.options.messages.serverCommunicationError);c._setEnabledOfDialogButton(b,true,c.options.messages.save);});},_updateRecordValuesFromServerResponse:function(b,c){if(!c||!c.Record)return;a.extend(true,b,c.Record);},_getValueForRecordField:function(a,b){var c=this.options.fields[b];var d=a[b];if(c.type=='date')return this._getDisplayTextForDateRecordField(c,d);else return d;},_updateRowTexts:function(a){var b=a.data('record');var c=a.find('td');for(var d=0;d<this._columnList.length;d++){var e=this._getDisplayTextForRecordField(b,this._columnList[d]);c.eq(this._firstDataColumnOffset+d).html(e||'');}this._onRowUpdated(a);},_showUpdateAnimationForRow:function(a){var b='jtable-row-updated';if(this.options.jqueryuiTheme)b=b+' ui-state-highlight';a.stop(true,true).addClass(b,'slow','',function(){a.removeClass(b,5000);});},_onRowUpdated:function(a){this._trigger("rowUpdated",null,{row:a,record:a.data('record')});},_onRecordUpdated:function(a,b){this._trigger("recordUpdated",null,{record:a.data('record'),row:a,serverResponse:b});}});})(jQuery);(function(a){var b={_create:a.hik.jtable.prototype._create,_addColumnsToHeaderRow:a.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:a.hik.jtable.prototype._addCellsToRowUsingRecord};a.extend(true,a.hik.jtable.prototype,{options:{deleteConfirmation:true,recordDeleted:function(a,b){},messages:{deleteConfirmation:'This record will be deleted. Are you sure?',deleteText:'Delete',deleting:'Deleting',canNotDeletedRecords:'Can not delete {0} of {1} records!',deleteProggress:'Deleting {0} of {1} records, processing...'}},_$deleteRecordDiv:null,_$deletingRow:null,_create:function(){b._create.apply(this,arguments);this._createDeleteDialogDiv();},_createDeleteDialogDiv:function(){var b=this;b._$deleteRecordDiv=a('<div><p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span><span class="jtable-delete-confirm-message"></span></p></div>').appendTo(b._$mainContainer);b._$deleteRecordDiv.dialog({autoOpen:false,show:b.options.dialogShowEffect,hide:b.options.dialogHideEffect,modal:true,title:b.options.messages.areYouSure,buttons:[{text:b.options.messages.cancel,click:function(){b._$deleteRecordDiv.dialog("close");}},{id:'DeleteDialogButton',text:b.options.messages.deleteText,click:function(){if(b._$deletingRow.hasClass('jtable-row-removed')){b._$deleteRecordDiv.dialog('close');return;}var c=a('#DeleteDialogButton');b._setEnabledOfDialogButton(c,false,b.options.messages.deleting);b._deleteRecordFromServer(b._$deletingRow,function(){b._removeRowsFromTableWithAnimation(b._$deletingRow);b._$deleteRecordDiv.dialog('close');},function(a){b._showError(a);b._setEnabledOfDialogButton(c,true,b.options.messages.deleteText);});}}],close:function(){var c=a('#DeleteDialogButton');b._setEnabledOfDialogButton(c,true,b.options.messages.deleteText);}});},deleteRows:function(b){var c=this;if(b.length<=0){c._logWarn('No rows specified to jTable deleteRows method.');return;}if(c._isBusy()){c._logWarn('Can not delete rows since jTable is busy!');return;}if(b.length==1){c._deleteRecordFromServer(b,function(){c._removeRowsFromTableWithAnimation(b);},function(a){c._showError(a);});return;}c._showBusy(c._formatString(c.options.messages.deleteProggress,0,b.length));var d=0;var e=function(){return(d>=b.length);};var f=function(){var a=b.filter('.jtable-row-ready-to-remove');if(a.length<b.length)c._showError(c._formatString(c.options.messages.canNotDeletedRecords,b.length-a.length,b.length));if(a.length>0)c._removeRowsFromTableWithAnimation(a);c._hideBusy();};var g=0;b.each(function(){var h=a(this);c._deleteRecordFromServer(h,function(){++g;++d;h.addClass('jtable-row-ready-to-remove');c._showBusy(c._formatString(c.options.messages.deleteProggress,g,b.length));if(e())f();},function(){++d;if(e())f();});});},deleteRecord:function(b){var c=this;b=a.extend({clientOnly:false,animationsEnabled:c.options.animationsEnabled,url:c.options.actions.deleteAction,success:function(){},error:function(){}},b);if(b.key==undefined){c._logWarn('options parameter in deleteRecord method must contain a key property.');return;}var d=c.getRowByKey(b.key);if(d==null){c._logWarn('Can not found any row by key: '+b.key);return;}if(b.clientOnly){c._removeRowsFromTableWithAnimation(d,b.animationsEnabled);b.success();return;}c._deleteRecordFromServer(d,function(a){c._removeRowsFromTableWithAnimation(d,b.animationsEnabled);b.success(a);},function(a){c._showError(a);b.error(a);},b.url);},_addColumnsToHeaderRow:function(a){b._addColumnsToHeaderRow.apply(this,arguments);if(this.options.actions.deleteAction!=undefined)a.append(this._createEmptyCommandHeader());},_addCellsToRowUsingRecord:function(c){b._addCellsToRowUsingRecord.apply(this,arguments);var d=this;if(d.options.actions.deleteAction!=undefined){var e=a('<span></span>').html(d.options.messages.deleteText);var f=a('<button title="'+d.options.messages.deleteText+'"></button>').addClass('jtable-command-button jtable-delete-command-button').append(e).click(function(a){a.preventDefault();a.stopPropagation();d._deleteButtonClickedForRow(c);});a('<td></td>').addClass('jtable-command-column').append(f).appendTo(c);}},_deleteButtonClickedForRow:function(b){var c=this;var d;var e=c.options.messages.deleteConfirmation;if(a.isFunction(c.options.deleteConfirmation)){var f={row:b,record:b.data('record'),deleteConfirm:true,deleteConfirmMessage:e,cancel:false,cancelMessage:null};c.options.deleteConfirmation(f);if(f.cancel){if(f.cancelMessage)c._showError(f.cancelMessage);return;}e=f.deleteConfirmMessage;d=f.deleteConfirm;}else d=c.options.deleteConfirmation;if(d!=false){c._$deleteRecordDiv.find('.jtable-delete-confirm-message').html(e);c._showDeleteDialog(b);}else c._deleteRecordFromServer(b,function(){c._removeRowsFromTableWithAnimation(b);},function(a){c._showError(a);});},_showDeleteDialog:function(a){this._$deletingRow=a;this._$deleteRecordDiv.dialog('open');},_deleteRecordFromServer:function(a,b,c,d){var e=this;if(a.data('deleting')==true)return;a.data('deleting',true);var f={};f[e._keyField]=e._getKeyValueOfRecord(a.data('record'));this._ajax({url:(d||e.options.actions.deleteAction),data:f,success:function(d){if(d.Result!='OK'){a.data('deleting',false);if(c)c(d.Message);return;}e._trigger("recordDeleted",null,{record:a.data('record'),row:a,serverResponse:d});if(b)b(d);},error:function(){a.data('deleting',false);if(c)c(e.options.messages.serverCommunicationError);}});},_removeRowsFromTableWithAnimation:function(a,b){var c=this;if(b==undefined)b=c.options.animationsEnabled;if(b){var d='jtable-row-deleting';if(this.options.jqueryuiTheme)d=d+' ui-state-disabled';a.stop(true,true).addClass(d,'slow','').promise().done(function(){c._removeRowsFromTable(a,'deleted');});}else c._removeRowsFromTable(a,'deleted');}});})(jQuery);(function(a){var b={_create:a.hik.jtable.prototype._create,_addColumnsToHeaderRow:a.hik.jtable.prototype._addColumnsToHeaderRow,_addCellsToRowUsingRecord:a.hik.jtable.prototype._addCellsToRowUsingRecord,_onLoadingRecords:a.hik.jtable.prototype._onLoadingRecords,_onRecordsLoaded:a.hik.jtable.prototype._onRecordsLoaded,_onRowsRemoved:a.hik.jtable.prototype._onRowsRemoved};a.extend(true,a.hik.jtable.prototype,{options:{selecting:false,multiselect:false,selectingCheckboxes:false,selectOnRowClick:true,selectionChanged:function(a,b){}},_selectedRecordIdsBeforeLoad:null,_$selectAllCheckbox:null,_shiftKeyDown:false,_create:function(){if(this.options.selecting&&this.options.selectingCheckboxes){++this._firstDataColumnOffset;this._bindKeyboardEvents();}b._create.apply(this,arguments);},_bindKeyboardEvents:function(){var b=this;a(document).keydown(function(a){switch(a.which){case 16:b._shiftKeyDown=true;break;}}).keyup(function(a){switch(a.which){case 16:b._shiftKeyDown=false;break;}});},selectedRows:function(){return this._getSelectedRows();},selectRows:function(a){this._selectRows(a);this._onSelectionChanged();},_addColumnsToHeaderRow:function(a){if(this.options.selecting&&this.options.selectingCheckboxes)if(this.options.multiselect)a.append(this._createSelectAllHeader());else a.append(this._createEmptyCommandHeader());b._addColumnsToHeaderRow.apply(this,arguments);},_addCellsToRowUsingRecord:function(a){if(this.options.selecting)this._makeRowSelectable(a);b._addCellsToRowUsingRecord.apply(this,arguments);},_onLoadingRecords:function(){if(this.options.selecting)this._storeSelectionList();b._onLoadingRecords.apply(this,arguments);},_onRecordsLoaded:function(){if(this.options.selecting)this._restoreSelectionList();b._onRecordsLoaded.apply(this,arguments);},_onRowsRemoved:function(a,c){if(this.options.selecting&&(c!='reloading')&&(a.filter('.jtable-row-selected').length>0))this._onSelectionChanged();b._onRowsRemoved.apply(this,arguments);},_createSelectAllHeader:function(){var b=this;var c=a('<th class=""></th>').addClass('jtable-command-column-header jtable-column-header-selecting');this._jqueryuiThemeAddClass(c,'ui-state-default');var d=a('<div />').addClass('jtable-column-header-container').appendTo(c);b._$selectAllCheckbox=a('<input type="checkbox" />').appendTo(d).click(function(){if(b._$tableRows.length<=0){b._$selectAllCheckbox.attr('checked',false);return;}var a=b._$tableBody.find('>tr.jtable-data-row');if(b._$selectAllCheckbox.is(':checked'))b._selectRows(a);else b._deselectRows(a);b._onSelectionChanged();});return c;},_storeSelectionList:function(){var b=this;if(!b.options.selecting)return;b._selectedRecordIdsBeforeLoad=[];b._getSelectedRows().each(function(){b._selectedRecordIdsBeforeLoad.push(b._getKeyValueOfRecord(a(this).data('record')));});},_restoreSelectionList:function(){var b=this;if(!b.options.selecting)return;var c=0;for(var d=0;d<b._$tableRows.length;++d){var e=b._getKeyValueOfRecord(b._$tableRows[d].data('record'));if(a.inArray(e,b._selectedRecordIdsBeforeLoad)>-1){b._selectRows(b._$tableRows[d]);++c;}}if(b._selectedRecordIdsBeforeLoad.length>0&&b._selectedRecordIdsBeforeLoad.length!=c)b._onSelectionChanged();b._selectedRecordIdsBeforeLoad=[];b._refreshSelectAllCheckboxState();},_getSelectedRows:function(){return this._$tableBody.find('>tr.jtable-row-selected');},_makeRowSelectable:function(b){var c=this;if(c.options.selectOnRowClick)b.click(function(){c._invertRowSelection(b);});if(c.options.selectingCheckboxes){var d=a('<td></td>').addClass('jtable-selecting-column');var e=a('<input type="checkbox" />').appendTo(d);if(!c.options.selectOnRowClick)e.click(function(){c._invertRowSelection(b);});b.append(d);}},_invertRowSelection:function(a){if(a.hasClass('jtable-row-selected'))this._deselectRows(a);else if(this._shiftKeyDown){var b=this._findRowIndex(a);var c=this._findFirstSelectedRowIndexBeforeIndex(b)+1;if(c>0&&c<b)this._selectRows(this._$tableBody.find('tr').slice(c,b+1));else{var d=this._findFirstSelectedRowIndexAfterIndex(b)-1;if(d>b)this._selectRows(this._$tableBody.find('tr').slice(b,d+1));else this._selectRows(a);}}else this._selectRows(a);this._onSelectionChanged();},_findFirstSelectedRowIndexBeforeIndex:function(a){for(var b=a-1;b>=0;--b)if(this._$tableRows[b].hasClass('jtable-row-selected'))return b;return -1;},_findFirstSelectedRowIndexAfterIndex:function(a){for(var b=a+1;b<this._$tableRows.length;++b)if(this._$tableRows[b].hasClass('jtable-row-selected'))return b;return -1;},_selectRows:function(a){if(!this.options.multiselect)this._deselectRows(this._getSelectedRows());a.addClass('jtable-row-selected');this._jqueryuiThemeAddClass(a,'ui-state-highlight');if(this.options.selectingCheckboxes)a.find('>td.jtable-selecting-column >input').prop('checked',true);this._refreshSelectAllCheckboxState();},_deselectRows:function(a){a.removeClass('jtable-row-selected ui-state-highlight');if(this.options.selectingCheckboxes)a.find('>td.jtable-selecting-column >input').prop('checked',false);this._refreshSelectAllCheckboxState();},_refreshSelectAllCheckboxState:function(){if(!this.options.selectingCheckboxes||!this.options.multiselect)return;var a=this._$tableRows.length;var b=this._getSelectedRows().length;if(b==0){this._$selectAllCheckbox.prop('indeterminate',false);this._$selectAllCheckbox.attr('checked',false);}else if(b==a){this._$selectAllCheckbox.prop('indeterminate',false);this._$selectAllCheckbox.attr('checked',true);}else{this._$selectAllCheckbox.attr('checked',false);this._$selectAllCheckbox.prop('indeterminate',true);}},_onSelectionChanged:function(){this._trigger("selectionChanged",null,{});}});})(jQuery);(function(a){var b={load:a.hik.jtable.prototype.load,_create:a.hik.jtable.prototype._create,_setOption:a.hik.jtable.prototype._setOption,_createRecordLoadUrl:a.hik.jtable.prototype._createRecordLoadUrl,_addRowToTable:a.hik.jtable.prototype._addRowToTable,_addRow:a.hik.jtable.prototype._addRow,_removeRowsFromTable:a.hik.jtable.prototype._removeRowsFromTable,_onRecordsLoaded:a.hik.jtable.prototype._onRecordsLoaded};a.extend(true,a.hik.jtable.prototype,{options:{paging:false,pageList:'normal',pageSize:10,pageSizes:[10,25,50,100,250,500],pageSizeChangeArea:true,gotoPageArea:'combobox',messages:{pagingInfo:'Showing {0}-{1} of {2}',pageSizeChangeLabel:'Row count',gotoPageLabel:'Go to page'}},_$bottomPanel:null,_$pagingListArea:null,_$pageSizeChangeArea:null,_$pageInfoSpan:null,_$gotoPageArea:null,_$gotoPageInput:null,_totalRecordCount:0,_currentPageNo:1,_create:function(){b._create.apply(this,arguments);if(this.options.paging){this._loadPagingSettings();this._createBottomPanel();this._createPageListArea();this._createGotoPageInput();this._createPageSizeSelection();}},_loadPagingSettings:function(){if(!this.options.saveUserPreferences)return;var a=this._getCookie('page-size');if(a)this.options.pageSize=this._normalizeNumber(a,1,1000000,this.options.pageSize);},_createBottomPanel:function(){this._$bottomPanel=a('<div />').addClass('jtable-bottom-panel').insertAfter(this._$table);this._jqueryuiThemeAddClass(this._$bottomPanel,'ui-state-default');a('<div />').addClass('jtable-left-area').appendTo(this._$bottomPanel);a('<div />').addClass('jtable-right-area').appendTo(this._$bottomPanel);},_createPageListArea:function(){this._$pagingListArea=a('<span></span>').addClass('jtable-page-list').appendTo(this._$bottomPanel.find('.jtable-left-area'));this._$pageInfoSpan=a('<span></span>').addClass('jtable-page-info').appendTo(this._$bottomPanel.find('.jtable-right-area'));},_createPageSizeSelection:function(){var b=this;if(!b.options.pageSizeChangeArea)return;if(b._findIndexInArray(b.options.pageSize,b.options.pageSizes)<0){b.options.pageSizes.push(parseInt(b.options.pageSize));b.options.pageSizes.sort(function(a,b){return a-b;});}b._$pageSizeChangeArea=a('<span></span>').addClass('jtable-page-size-change').appendTo(b._$bottomPanel.find('.jtable-left-area'));b._$pageSizeChangeArea.append('<span>'+b.options.messages.pageSizeChangeLabel+': </span>');var c=a('<select></select>').appendTo(b._$pageSizeChangeArea);for(var d=0;d<b.options.pageSizes.length;d++)c.append('<option value="'+b.options.pageSizes[d]+'">'+b.options.pageSizes[d]+'</option>');c.val(b.options.pageSize);c.change(function(){b._changePageSize(parseInt(a(this).val()));});},_createGotoPageInput:function(){var b=this;if(!b.options.gotoPageArea||b.options.gotoPageArea=='none')return;this._$gotoPageArea=a('<span></span>').addClass('jtable-goto-page').appendTo(b._$bottomPanel.find('.jtable-left-area'));this._$gotoPageArea.append('<span>'+b.options.messages.gotoPageLabel+': </span>');if(b.options.gotoPageArea=='combobox'){b._$gotoPageInput=a('<select></select>').appendTo(this._$gotoPageArea).data('pageCount',1).change(function(){b._changePage(parseInt(a(this).val()));});b._$gotoPageInput.append('<option value="1">1</option>');}else b._$gotoPageInput=a('<input type="text" maxlength="10" value="'+b._currentPageNo+'" />').appendTo(this._$gotoPageArea).keypress(function(a){if(a.which==13){a.preventDefault();b._changePage(parseInt(b._$gotoPageInput.val()));}else if(a.which==43){a.preventDefault();b._changePage(parseInt(b._$gotoPageInput.val())+1);}else if(a.which==45){a.preventDefault();b._changePage(parseInt(b._$gotoPageInput.val())-1);}else{var c=((47<a.keyCode&&a.keyCode<58&&a.shiftKey==false&&a.altKey==false)||(a.keyCode==8)||(a.keyCode==9));if(!c)a.preventDefault();}});},_refreshGotoPageInput:function(){if(!this.options.gotoPageArea||this.options.gotoPageArea=='none')return;if(this._totalRecordCount<=0)this._$gotoPageArea.hide();else this._$gotoPageArea.show();if(this.options.gotoPageArea=='combobox'){var a=this._$gotoPageInput.data('pageCount');var b=this._calculatePageCount();if(a!=b){this._$gotoPageInput.empty();var c=1;if(b>10000)c=100;else if(b>5000)c=10;else if(b>2000)c=5;else if(b>1000)c=2;for(var d=c;d<=b;d+=c)this._$gotoPageInput.append('<option value="'+d+'">'+d+'</option>');this._$gotoPageInput.data('pageCount',b);}}this._$gotoPageInput.val(this._currentPageNo);},load:function(){this._currentPageNo=1;b.load.apply(this,arguments);},_setOption:function(a,c){b._setOption.apply(this,arguments);if(a=='pageSize')this._changePageSize(parseInt(c));},_changePageSize:function(a){if(a==this.options.pageSize)return;this.options.pageSize=a;var b=this._calculatePageCount();if(this._currentPageNo>b)this._currentPageNo=b;if(this._currentPageNo<=0)this._currentPageNo=1;var c=this._$bottomPanel.find('.jtable-page-size-change select');if(c.length>0)if(parseInt(c.val())!=a){var d=c.find('option[value='+a+']');if(d.length>0)c.val(a);}this._savePagingSettings();this._reloadTable();},_savePagingSettings:function(){if(!this.options.saveUserPreferences)return;this._setCookie('page-size',this.options.pageSize);},_createRecordLoadUrl:function(){var a=b._createRecordLoadUrl.apply(this,arguments);a=this._addPagingInfoToUrl(a,this._currentPageNo);return a;},_addRowToTable:function(a,c,d){if(d&&this.options.paging){this._reloadTable();return;}b._addRowToTable.apply(this,arguments);},_addRow:function(a,c){if(c&&c.isNewRow&&this.options.paging){this._reloadTable();return;}b._addRow.apply(this,arguments);},_removeRowsFromTable:function(a,c){b._removeRowsFromTable.apply(this,arguments);if(this.options.paging){if(this._$tableRows.length<=0&&this._currentPageNo>1)--this._currentPageNo;this._reloadTable();}},_onRecordsLoaded:function(a){if(this.options.paging){this._totalRecordCount=a.TotalRecordCount;this._createPagingList();this._createPagingInfo();this._refreshGotoPageInput();}b._onRecordsLoaded.apply(this,arguments);},_addPagingInfoToUrl:function(a,b){if(!this.options.paging)return a;var c=(b-1)*this.options.pageSize;var d=this.options.pageSize;var e='jtStartIndex';var f='jtPageSize';if(this.options.tastypie){e='offset';f='limit';}return(a+(a.indexOf('?')<0?'?':'&')+e+'='+c+'&'+f+'='+d);},_createPagingList:function(){if(this.options.pageSize<=0)return;this._$pagingListArea.empty();if(this._totalRecordCount<=0)return;var a=this._calculatePageCount();this._createFirstAndPreviousPageButtons();if(this.options.pageList=='normal')this._createPageNumberButtons(this._calculatePageNumbers(a));this._createLastAndNextPageButtons(a);this._bindClickEventsToPageNumberButtons();},_createFirstAndPreviousPageButtons:function(){var b=a('<span></span>').addClass('jtable-page-number-first').html('&lt&lt').data('pageNumber',1).appendTo(this._$pagingListArea);var c=a('<span></span>').addClass('jtable-page-number-previous').html('&lt').data('pageNumber',this._currentPageNo-1).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass(b,'ui-button ui-state-default','ui-state-hover');this._jqueryuiThemeAddClass(c,'ui-button ui-state-default','ui-state-hover');if(this._currentPageNo<=1){b.addClass('jtable-page-number-disabled');c.addClass('jtable-page-number-disabled');this._jqueryuiThemeAddClass(b,'ui-state-disabled');this._jqueryuiThemeAddClass(c,'ui-state-disabled');}},_createLastAndNextPageButtons:function(b){var c=a('<span></span>').addClass('jtable-page-number-next').html('&gt').data('pageNumber',this._currentPageNo+1).appendTo(this._$pagingListArea);var d=a('<span></span>').addClass('jtable-page-number-last').html('&gt&gt').data('pageNumber',b).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass(c,'ui-button ui-state-default','ui-state-hover');this._jqueryuiThemeAddClass(d,'ui-button ui-state-default','ui-state-hover');if(this._currentPageNo>=b){c.addClass('jtable-page-number-disabled');d.addClass('jtable-page-number-disabled');this._jqueryuiThemeAddClass(c,'ui-state-disabled');this._jqueryuiThemeAddClass(d,'ui-state-disabled');}},_createPageNumberButtons:function(b){var c=0;for(var d=0;d<b.length;d++){if((b[d]-c)>1)a('<span></span>').addClass('jtable-page-number-space').html('...').appendTo(this._$pagingListArea);this._createPageNumberButton(b[d]);c=b[d];}},_createPageNumberButton:function(b){var c=a('<span></span>').addClass('jtable-page-number').html(b).data('pageNumber',b).appendTo(this._$pagingListArea);this._jqueryuiThemeAddClass(c,'ui-button ui-state-default','ui-state-hover');if(this._currentPageNo==b){c.addClass('jtable-page-number-active jtable-page-number-disabled');this._jqueryuiThemeAddClass(c,'ui-state-active');}},_calculatePageCount:function(){var a=Math.floor(this._totalRecordCount/this.options.pageSize);if(this._totalRecordCount%this.options.pageSize!=0)++a;return a;},_calculatePageNumbers:function(a){if(a<=4){var b=[];for(var c=1;c<=a;++c)b.push(c);return b;}else{var d=[1,2,a-1,a];var e=this._normalizeNumber(this._currentPageNo-1,1,a,1);var f=this._normalizeNumber(this._currentPageNo+1,1,a,1);this._insertToArrayIfDoesNotExists(d,e);this._insertToArrayIfDoesNotExists(d,this._currentPageNo);this._insertToArrayIfDoesNotExists(d,f);d.sort(function(a,b){return a-b;});return d;}},_createPagingInfo:function(){if(this._totalRecordCount<=0){this._$pageInfoSpan.empty();return;}var a=(this._currentPageNo-1)*this.options.pageSize+1;var b=this._currentPageNo*this.options.pageSize;b=this._normalizeNumber(b,a,this._totalRecordCount,0);if(b>=a){var c=this._formatString(this.options.messages.pagingInfo,a,b,this._totalRecordCount);this._$pageInfoSpan.html(c);}},_bindClickEventsToPageNumberButtons:function(){var b=this;b._$pagingListArea.find('.jtable-page-number,.jtable-page-number-previous,.jtable-page-number-next,.jtable-page-number-first,.jtable-page-number-last').not('.jtable-page-number-disabled').click(function(c){c.preventDefault();b._changePage(a(this).data('pageNumber'));});},_changePage:function(a){a=this._normalizeNumber(a,1,this._calculatePageCount(),1);if(a==this._currentPageNo){this._refreshGotoPageInput();return;}this._currentPageNo=a;this._reloadTable();}});})(jQuery);(function(a){var b={_initializeFields:a.hik.jtable.prototype._initializeFields,_normalizeFieldOptions:a.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:a.hik.jtable.prototype._createHeaderCellForField,_createRecordLoadUrl:a.hik.jtable.prototype._createRecordLoadUrl};a.extend(true,a.hik.jtable.prototype,{options:{sorting:false,multiSorting:false,defaultSorting:''},_lastSorting:null,_initializeFields:function(){b._initializeFields.apply(this,arguments);this._lastSorting=[];if(this.options.sorting)this._buildDefaultSortingArray();},_normalizeFieldOptions:function(a,c){b._normalizeFieldOptions.apply(this,arguments);c.sorting=(c.sorting!=false);},_createHeaderCellForField:function(a,c){var d=b._createHeaderCellForField.apply(this,arguments);if(this.options.sorting&&c.sorting)this._makeColumnSortable(d,a);return d;},_createRecordLoadUrl:function(){var a=b._createRecordLoadUrl.apply(this,arguments);a=this._addSortingInfoToUrl(a);return a;},_buildDefaultSortingArray:function(){var b=this;a.each(b.options.defaultSorting.split(","),function(c,d){a.each(b.options.fields,function(a,c){if(c.sorting){var e=d.indexOf(a);if(e>-1)if(d.toUpperCase().indexOf('DESC',e)>-1)b._lastSorting.push({fieldName:a,sortOrder:'DESC'});else b._lastSorting.push({fieldName:a,sortOrder:'ASC'});}});});},_makeColumnSortable:function(b,c){var d=this;b.addClass('jtable-column-header-sortable').click(function(a){a.preventDefault();if(!d.options.multiSorting||!a.ctrlKey)d._lastSorting=[];d._sortTableByColumn(b);});a.each(this._lastSorting,function(a,d){if(d.fieldName==c)if(d.sortOrder=='DESC')b.addClass('jtable-column-header-sorted-desc');else b.addClass('jtable-column-header-sorted-asc');});},_sortTableByColumn:function(a){if(this._lastSorting.length==0)a.siblings().removeClass('jtable-column-header-sorted-asc jtable-column-header-sorted-desc');for(var b=0;b<this._lastSorting.length;b++)if(this._lastSorting[b].fieldName==a.data('fieldName'))this._lastSorting.splice(b--,1);if(a.hasClass('jtable-column-header-sorted-asc')){a.removeClass('jtable-column-header-sorted-asc').addClass('jtable-column-header-sorted-desc');this._lastSorting.push({'fieldName':a.data('fieldName'),sortOrder:'DESC'});}else{a.removeClass('jtable-column-header-sorted-desc').addClass('jtable-column-header-sorted-asc');this._lastSorting.push({'fieldName':a.data('fieldName'),sortOrder:'ASC'});}this._reloadTable();},_addSortingInfoToUrl:function(b){var c=this;if(!c.options.sorting||c._lastSorting.length==0)return b;var d=[];a.each(c._lastSorting,function(a,b){if(c.options.tastypie){var e=(b.sortOrder=='ASC'?'':'-');d.push(e+b.fieldName);}else d.push(b.fieldName+' '+b.sortOrder);});if(c.options.tastypie)return(b+(b.indexOf('?')<0?'?':'&')+'order_by='+d.join("&order_by="));else return(b+(b.indexOf('?')<0?'?':'&')+'jtSorting='+d.join(","));}});})(jQuery);(function(a){var b={_create:a.hik.jtable.prototype._create,_normalizeFieldOptions:a.hik.jtable.prototype._normalizeFieldOptions,_createHeaderCellForField:a.hik.jtable.prototype._createHeaderCellForField,_createCellForRecordField:a.hik.jtable.prototype._createCellForRecordField};a.extend(true,a.hik.jtable.prototype,{options:{tableId:undefined,columnResizable:true,columnSelectable:true},_$columnSelectionDiv:null,_$columnResizeBar:null,_cookieKeyPrefix:null,_currentResizeArgs:null,_create:function(){b._create.apply(this,arguments);this._createColumnResizeBar();this._createColumnSelection();if(this.options.saveUserPreferences)this._loadColumnSettings();this._normalizeColumnWidths();},_normalizeFieldOptions:function(a,c){b._normalizeFieldOptions.apply(this,arguments);if(this.options.columnResizable)c.columnResizable=(c.columnResizable!=false);if(!c.visibility)c.visibility='visible';},_createHeaderCellForField:function(a,c){var d=b._createHeaderCellForField.apply(this,arguments);if(this.options.columnResizable&&c.columnResizable&&(a!=this._columnList[this._columnList.length-1]))this._makeColumnResizable(d);if(c.visibility=='hidden')d.hide();return d;},_createCellForRecordField:function(a,c){var d=b._createCellForRecordField.apply(this,arguments);var e=this.options.fields[c];if(e.visibility=='hidden')d.hide();return d;},changeColumnVisibility:function(a,b){this._changeColumnVisibilityInternal(a,b);this._normalizeColumnWidths();if(this.options.saveUserPreferences)this._saveColumnSettings();},_changeColumnVisibilityInternal:function(a,b){var c=this._columnList.indexOf(a);if(c<0){this._logWarn('Column "'+a+'" does not exist in fields!');return;}if(['visible','hidden','fixed'].indexOf(b)<0){this._logWarn('Visibility value is not valid: "'+b+'"! Options are: visible, hidden, fixed.');return;}var d=this.options.fields[a];if(d.visibility==b)return;var e=this._firstDataColumnOffset+c+1;if(d.visibility!='hidden'&&b=='hidden')this._$table.find('>thead >tr >th:nth-child('+e+'),>tbody >tr >td:nth-child('+e+')').hide();else if(d.visibility=='hidden'&&b!='hidden')this._$table.find('>thead >tr >th:nth-child('+e+'),>tbody >tr >td:nth-child('+e+')').show().css('display','table-cell');d.visibility=b;},_createColumnSelection:function(){var b=this;this._$columnSelectionDiv=a('<div />').addClass('jtable-column-selection-container').appendTo(b._$mainContainer);this._$table.children('thead').bind('contextmenu',function(c){if(!b.options.columnSelectable)return;c.preventDefault();a('<div />').addClass('jtable-contextmenu-overlay').click(function(){a(this).remove();b._$columnSelectionDiv.hide();}).bind('contextmenu',function(){return false;}).appendTo(document.body);b._fillColumnSelection();var d=b._$mainContainer.offset();var e=c.pageY-d.top;var f=c.pageX-d.left;var g=100;var h=b._$mainContainer.width();if((h>g)&&(f>(h-g)))f=h-g;b._$columnSelectionDiv.css({left:f,top:e,'min-width':g+'px'}).show();});},_fillColumnSelection:function(){var b=this;var c=a('<ul></ul>').addClass('jtable-column-select-list');for(var d=0;d<this._columnList.length;d++){var e=this._columnList[d];var f=this.options.fields[e];var g=a('<li></li>').appendTo(c);var h=a('<label for="'+e+'"></label>').append(a('<span>'+(f.title||e)+'</span>')).appendTo(g);var i=a('<input type="checkbox" name="'+e+'">').prependTo(h).click(function(){var c=a(this);var d=c.attr('name');var e=b.options.fields[d];if(e.visibility=='fixed')return;b.changeColumnVisibility(d,c.is(':checked')?'visible':'hidden');});if(f.visibility!='hidden')i.attr('checked','checked');if(f.visibility=='fixed')i.attr('disabled','disabled');}this._$columnSelectionDiv.html(c);},_createColumnResizeBar:function(){this._$columnResizeBar=a('<div />').addClass('jtable-column-resize-bar').appendTo(this._$mainContainer).hide();},_makeColumnResizable:function(b){var c=this;a('<div />').addClass('jtable-column-resize-handler').appendTo(b.find('.jtable-column-header-container')).mousedown(function(d){d.preventDefault();d.stopPropagation();var e=c._$mainContainer.offset();var f=b.nextAll('th.jtable-column-header:visible:first');if(!f.length)return;var g=10;c._currentResizeArgs={currentColumnStartWidth:b.outerWidth(),minWidth:g,maxWidth:b.outerWidth()+f.outerWidth()-g,mouseStartX:d.pageX,minResizeX:function(){return this.mouseStartX-(this.currentColumnStartWidth-this.minWidth);},maxResizeX:function(){return this.mouseStartX+(this.maxWidth-this.currentColumnStartWidth);}};var h=function(a){if(!c._currentResizeArgs)return;var b=c._normalizeNumber(a.pageX,c._currentResizeArgs.minResizeX(),c._currentResizeArgs.maxResizeX());c._$columnResizeBar.css('left',(b-e.left)+'px');};var i=function(d){if(!c._currentResizeArgs)return;a(document).unbind('mousemove',h);a(document).unbind('mouseup',i);c._$columnResizeBar.hide();var e=d.pageX-c._currentResizeArgs.mouseStartX;var g=c._normalizeNumber(c._currentResizeArgs.currentColumnStartWidth+e,c._currentResizeArgs.minWidth,c._currentResizeArgs.maxWidth);var j=f.outerWidth()+(c._currentResizeArgs.currentColumnStartWidth-g);var k=b.data('width-in-percent')/c._currentResizeArgs.currentColumnStartWidth;b.data('width-in-percent',g*k);f.data('width-in-percent',j*k);b.css('width',b.data('width-in-percent')+'%');f.css('width',f.data('width-in-percent')+'%');c._normalizeColumnWidths();c._currentResizeArgs=null;if(c.options.saveUserPreferences)c._saveColumnSettings();};c._$columnResizeBar.show().css({top:(b.offset().top-e.top)+'px',left:(d.pageX-e.left)+'px',height:(c._$table.outerHeight())+'px'});a(document).bind('mousemove',h);a(document).bind('mouseup',i);});},_normalizeColumnWidths:function(){var b=this._$table.find('>thead th.jtable-command-column-header').data('width-in-percent',1).css('width','1%');var c=this._$table.find('>thead th.jtable-column-header');var d=0;c.each(function(){var b=a(this);if(b.is(':visible'))d+=b.outerWidth();});var e={};var f=100.0-b.length;c.each(function(){var b=a(this);if(b.is(':visible')){var c=b.data('fieldName');var g=b.outerWidth()*f/d;e[c]=g;}});c.each(function(){var b=a(this);if(b.is(':visible')){var c=b.data('fieldName');b.data('width-in-percent',e[c]).css('width',e[c]+'%');}});},_saveColumnSettings:function(){var b=this;var c='';this._$table.find('>thead >tr >th.jtable-column-header').each(function(){var d=a(this);var e=d.data('fieldName');var f=d.data('width-in-percent');var g=b.options.fields[e].visibility;var h=e+"="+g+';'+f;c=c+h+'|';});this._setCookie('column-settings',c.substr(0,c.length-1));},_loadColumnSettings:function(){var b=this;var c=this._getCookie('column-settings');if(!c)return;var d={};a.each(c.split('|'),function(a,b){var c=b.split('=');var e=c[0];var f=c[1].split(';');d[e]={columnVisibility:f[0],columnWidth:f[1]};});var e=this._$table.find('>thead >tr >th.jtable-column-header');e.each(function(){var c=a(this);var e=c.data('fieldName');var f=b.options.fields[e];if(d[e]){if(f.visibility!='fixed')b._changeColumnVisibilityInternal(e,d[e].columnVisibility);c.data('width-in-percent',d[e].columnWidth).css('width',d[e].columnWidth+'%');}});}});})(jQuery);(function(a){var b={_removeRowsFromTable:a.hik.jtable.prototype._removeRowsFromTable};a.extend(true,a.hik.jtable.prototype,{options:{openChildAsAccordion:false},openChildTable:function(b,c,d){var e=this;if(c.jqueryuiTheme==undefined)c.jqueryuiTheme=e.options.jqueryuiTheme;c.showCloseButton=(c.showCloseButton!=false);if(c.showCloseButton&&!c.closeRequested)c.closeRequested=function(){e.closeChildTable(b);};if(e.options.openChildAsAccordion)b.siblings('.jtable-data-row').each(function(){e.closeChildTable(a(this));});e.closeChildTable(b,function(){var f=e.getChildRow(b).children('td').empty();var g=a('<div />').addClass('jtable-child-table-container').appendTo(f);f.data('childTable',g);g.jtable(c);e.openChildRow(b);g.hide().slideDown('fast',function(){if(d)d({childTable:g});});});},closeChildTable:function(a,b){var c=this;var d=this.getChildRow(a).children('td');var e=d.data('childTable');if(!e){if(b)b();return;}d.data('childTable',null);e.slideUp('fast',function(){e.jtable('destroy');e.remove();c.closeChildRow(a);if(b)b();});},isChildRowOpen:function(a){return(this.getChildRow(a).is(':visible'));},getChildRow:function(a){return a.data('childRow')||this._createChildRow(a);},openChildRow:function(a){var b=this.getChildRow(a);if(!b.is(':visible'))b.show();return b;},closeChildRow:function(a){var b=this.getChildRow(a);if(b.is(':visible'))b.hide();},_removeRowsFromTable:function(c,d){var e=this;if(d=='deleted')c.each(function(){var b=a(this);var c=b.data('childRow');if(c){e.closeChildTable(b);c.remove();}});b._removeRowsFromTable.apply(this,arguments);},_createChildRow:function(b){var c=this._$table.find('thead th').length;var d=a('<tr></tr>').addClass('jtable-child-row').append('<td colspan="'+c+'"></td>');b.after(d);b.data('childRow',d);d.hide();return d;}});})(jQuery);